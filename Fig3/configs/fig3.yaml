# Fig.3 configuration (linked I/O across modules)
# Includes: Monocle3 + Length~Pseudotime + GO + SCENIC (Step1+2+downstream) + Seurat->H5AD + scTour

# -----------------------------
# (A) Monocle3 / Seurat workflow
# -----------------------------
input_rds: "obj_oo.rds"
out_dir: "results/Fig3"
out_obj_rds: "results/Fig3/obj_with_pseudotime.rds"

num_dim: 50
root_cluster: "6"

cores: 8
q_value_thr: 0.05
morans_I_thr: 0.2

pseudotime_bins: 13

module_resolution: 0.0009
module_seed: 888

out_deg_csv: "results/Fig3/deg_graph_test.csv"
out_pr_deg_ids: "results/Fig3/pr_deg_ids.txt"
out_gene_modules_csv: "results/Fig3/gene_modules.csv"

plot_out_pdf: "results/Fig3/length_vs_pseudotime.pdf"
plot_out_png: "results/Fig3/length_vs_pseudotime.png"
plot_loess_span: 0.5
plot_linewidth: 1
plot_alpha: 0.15
plot_color: "#e64b35"
plot_xlabel: "Pseudotime"
plot_ylabel: "Diameter(Âµm)"
plot_cor_method: "pearson"
plot_out_cor_txt: "results/Fig3/length_vs_pseudotime_correlation.txt"

go_out_csv: "results/Fig3/GO_BP_merged_modules_simplified.csv"
go_keyType: "SYMBOL"
go_ont: "BP"
go_pAdjustMethod: "BH"
go_pvalueCutoff: 0.05
go_qvalueCutoff: 0.2
go_simplify_cutoff: 0.7
go_simplify_by: "p.adjust"
go_simplify_select_fun: "min"
go_merge_map:
  M1: ["3"]
  M2: ["1"]
  M3: ["4"]
  M4: ["5"]
  M5: ["2"]

# -----------------------------
# (B) SCENIC Step 1: Seurat -> CSV (cells x genes)
# -----------------------------
scenic_out_dir: "results/Fig3/scenic"
scenic_out_csv: "results/Fig3/scenic/oocyte_1211_withoutMII.csv"

scenic_stage_column: "stage"
scenic_exclude_stage_value: "MII"
scenic_assay: "RNA"
scenic_slot: "counts"
scenic_transpose: true

# -----------------------------
# (C) SCENIC Step 2: CSV -> loom + pySCENIC
# -----------------------------
scenic_loom: "results/Fig3/scenic/oocyte_1211_withoutMII.loom"
scenic_adj_tsv: "results/Fig3/scenic/adj_oocyte_1211_withoutMII.tsv"
scenic_reg_csv: "results/Fig3/scenic/reg_oocyte_1211_withoutMII.csv"
scenic_result_loom: "results/Fig3/scenic/oocyte_1211_withoutMII_result.loom"

# pySCENIC resources (update these paths to where your files are)
scenic_tf_list: "allTFs_mm.txt"
scenic_rankings_feather: "mm10_10kbp_up_10kbp_down_full_tx_v10_clust.genes_vs_motifs.rankings.feather"
scenic_motif_annotations: "motifs-v10nr_clust-nr.mgi-m0.001-o0.0.tbl"
scenic_pyscenic_bin: "pyscenic"

scenic_grn_workers: 14
scenic_grn_method: "grnboost2"

scenic_ctx_workers: 30
scenic_ctx_mode: "dask_multiprocessing"
scenic_ctx_mask_dropouts: true

scenic_aucell_workers: 16

# -----------------------------
# (D) SCENIC Downstream: RSS by pseudotime_bin_q
# -----------------------------
# If you omit scenic_downstream_input_rds, the script auto-uses out_obj_rds.
# scenic_downstream_input_rds: "results/Fig3/obj_with_pseudotime.rds"
scenic_downstream_out_dir: "results/Fig3/scenic/downstream"

# cell annotation column in Seurat meta.data
scenic_rss_var: "pseudotime_bin_q"

# keep which pseudotime bins/labels in the RSS heatmap (optional)
# scenic_rss_keep_levels: ["1","2","3","4","5","6","7","8","9","10"]

# plotRSS parameters
scenic_rss_zThreshold: 1
scenic_rss_thr: 0.1
scenic_rss_cluster_columns: false
scenic_rss_order_rows: true
scenic_rss_col_low: "#005887"
scenic_rss_col_mid: "#926987"
scenic_rss_col_high: "#ED7B86"
scenic_rss_revCol: false
scenic_rss_verbose: true

# outputs
scenic_rss_csv: "results/Fig3/scenic/downstream/rss_matrix.csv"
scenic_rss_plot_pdf: "results/Fig3/scenic/downstream/rss_plot.pdf"
scenic_rss_plot_png: "results/Fig3/scenic/downstream/rss_plot.png"
scenic_regulons_rds: "results/Fig3/scenic/downstream/regulons_list.rds"
scenic_auc_thresholds_rds: "results/Fig3/scenic/downstream/regulon_auc_thresholds.rds"

# -----------------------------
# (E) Seurat RDS -> H5AD (linked to out_obj_rds; for scTour)
# -----------------------------
rds2h5ad_output_h5ad: "results/Fig3/sctour/seurat_to_h5ad.h5ad"
rds2h5ad_main_layer: "data"

# -----------------------------
# (F) scTour TNODE workflow (uses H5AD from step E)
# -----------------------------
sctour_input_h5ad: "results/Fig3/sctour/seurat_to_h5ad.h5ad"
sctour_out_dir: "results/Fig3/sctour"
sctour_output_h5ad: "results/Fig3/sctour/oocyte_sctour_tnode.h5ad"
sctour_ptime_csv: "results/Fig3/sctour/ptime.csv"

sctour_use_gpu: false
sctour_loss_mode: "mse"
sctour_alpha_recon_lec: 0.5
sctour_alpha_recon_lode: 0.5
sctour_hvg_n_top_genes: 1000
sctour_alpha_z: 0.5
sctour_alpha_predz: 0.5
